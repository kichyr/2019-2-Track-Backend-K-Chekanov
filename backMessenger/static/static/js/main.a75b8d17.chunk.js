(this["webpackJsonptrack-mail-2019-kichyr"]=this["webpackJsonptrack-mail-2019-kichyr"]||[]).push([[0],{10:function(e,t,a){e.exports={dialog_list_wrap:"DialogList_dialog_list_wrap__8jDdH",translating:"DialogList_translating__2VsUs",modal:"DialogList_modal__2jYn0","modal-content":"DialogList_modal-content__2sQCj",close:"DialogList_close__mj83R",plusbut:"DialogList_plusbut__5xaUS","horizontal-plus":"DialogList_horizontal-plus__2hIb5","vertical-plus":"DialogList_vertical-plus__2al7V",container:"DialogList_container__TgqVT",dialogsListContainer:"DialogList_dialogsListContainer__rSctl",chatwrap:"DialogList_chatwrap__3ibf_",wrap:"DialogList_wrap__2BclI",meta:"DialogList_meta__3QcWi",addinfo:"DialogList_addinfo__39jLj",chatImg:"DialogList_chatImg__3neQO",preview:"DialogList_preview__1B4wF",topic:"DialogList_topic__30BO-",dot:"DialogList_dot__3C_N6"}},16:function(e,t,a){e.exports={attachmentType:"styles_attachmentType__3eIKC",message_form:"styles_message_form__1Sm1a",input_panel:"styles_input_panel__1ju52",sendMessForm:"styles_sendMessForm__3A8xD",result:"styles_result__3ivTG",resultDrag:"styles_resultDrag__3F2jK",messageText:"styles_messageText__3PziE"}},17:function(e,t,a){e.exports={profileImg:"styles_profileImg__2xgSU",profile_form:"styles_profile_form__3nryD",topLineContainer:"styles_topLineContainer__-JsNv",profileTopic:"styles_profileTopic__1KL6U",name:"styles_name__1J8hG",status:"styles_status__344Hm"}},21:function(e,t,a){e.exports={modal:"createNewChatForm_modal__2X5FK",modal_content:"createNewChatForm_modal_content__VsNJG",close:"createNewChatForm_close__3DTMr"}},22:function(e,t,a){e.exports={dateTime:"singleMessage_dateTime__2etYS",singleMessContainer:"singleMessage_singleMessContainer__3QHsN",singleMess:"singleMessage_singleMess__2Tm8v",msg:"singleMessage_msg__1XUX_"}},24:function(e,t,a){e.exports={plusbut:"plusButtonStyles_plusbut__ICY__",horizontal_plus:"plusButtonStyles_horizontal_plus__HIBYs",vertical_plus:"plusButtonStyles_vertical_plus__3Wy4d"}},25:function(e,t,a){e.exports={container:"topLine_container__1R9Zm",chatImg:"topLine_chatImg__1A5Li",topic:"topLine_topic__1fCyY"}},26:function(e,t,a){e.exports={arrow:"backArrow_arrow__ANJaT",arrowTop:"backArrow_arrowTop__291_W",arrowBottom:"backArrow_arrowBottom__2hX51"}},53:function(e,t,a){e.exports=a(89)},73:function(e,t,a){},74:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(23),r=a.n(c),o=a(19),l=a(15),i=a(4),p=a(7),u=a(3),g=a.n(u),d=a(18),m=a(6),h=a(41);a(73);var f=function(){return s.a.createElement("div",{className:"burgerButt"},s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null))};a(74);function v(){return s.a.createElement("input",{type:"text",placeholder:"Search.."})}var _=function(){return s.a.createElement("div",{className:"container"},s.a.createElement(f,null),s.a.createElement(v,null))},b=a(10),E=a.n(b),w=a(11),x=a(24),y=a(21),S=a(44),C=a.n(S),O={userId:1},D="http://18.185.239.49/";var j=function(e){return s.a.createElement("div",null,"".concat(e.first_name," ").concat(e.last_name))};var L=function(e){var t=e.selectedUsers,a=e.setSelectedUsers,c=Object(n.useState)({value:"",suggestions:[]}),r=Object(p.a)(c,2),o=r[0],l=r[1],u={placeholder:"Type a some part of user name",value:o.value,onChange:function(e,t){var a=t.newValue;l(Object(i.a)({},o,{value:a}))}.bind(this)};return s.a.createElement(C.a,{suggestions:o.suggestions,onSuggestionsFetchRequested:function(e){!function(e,t){g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:fetch(D+"users/profile/"+e,{crossDomain:!0,mode:"cors",method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(a){var n=JSON.parse(a);t({value:e,suggestions:n.users})}));case 1:case"end":return a.stop()}}))}(e.value,l)},onSuggestionsClearRequested:function(){l({value:"",suggestions:[]})},getSuggestionValue:function(e){return e.name},renderSuggestion:j,inputProps:u,onSuggestionSelected:function(e,n){var s=n.suggestion;console.log(s),a([].concat(Object(w.a)(t),[s]))}})};function N(e){var t=e.setHiding;return s.a.createElement("div",{role:"button",id:"isActiveForSetHiding",tabIndex:0,className:x.plusbut,onClick:t},s.a.createElement("div",{className:x.horizontal_plus,id:"isActiveForSetHiding"}),s.a.createElement("div",{className:x.vertical_plus,id:"isActiveForSetHiding"}))}function k(e){var t=e.isHide,a=e.setHiding,c=e.setChats,r=e.chats,o=Object(n.useState)([]),l=Object(p.a)(o,2),i=l[0],u=l[1],g=null;return Object(n.useEffect)((function(){u([])}),[t]),s.a.createElement("div",{className:y.modal,id:"isActiveForSetHiding",style:t?{display:"block"}:{display:"none"},role:"button",tabIndex:0,onClick:a},s.a.createElement("div",{className:y.modal_content},s.a.createElement("span",{className:y.close,id:"isActiveForSetHiding",role:"button",tabIndex:0,onClick:a},"\xd7"),s.a.createElement("h2",null,"Create new chat"),s.a.createElement("br",null),s.a.createElement("input",{className:y.topic,ref:function(e){g=e},type:"text",name:"topic",placeholder:"Chat Topic"}),s.a.createElement(L,{selectedUsers:i,setSelectedUsers:u}),s.a.createElement("div",{style:{width:"80%"}},i.map((function(e,t){return s.a.createElement("div",{key:t.toString()},s.a.createElement("p",null,"".concat(e.first_name," ").concat(e.last_name)))}))),s.a.createElement("button",{onClick:function(e){e.preventDefault(),c(function(){var e=function(e,t){var a={topic:e,users_ids:t.map((function(e,t){return e.id}))};return fetch(D+"chats/create_chat",{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()}))}(g.value,i);return[].concat(Object(w.a)(r),[e])}()),a(e)}},s.a.createElement("span",{id:"isActiveForSetHiding"},"Create new chat"))))}var T=function(e){var t=e.setChats,a=e.chats,c=Object(n.useState)(!1),r=Object(p.a)(c,2),o=r[0],l=r[1],i=function(e){e.preventDefault(),e.stopPropagation(),"isActiveForSetHiding"===e.target.id&&l(!o)};return s.a.createElement(s.a.Fragment,null,s.a.createElement(N,{setHiding:i}),s.a.createElement(k,{isHide:o,setHiding:i,setChats:t,chats:a}))},I=function e(t){var a,n,s;return g.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,g.a.awrap(fetch(D+"users/contacts_list",{crossDomain:!0,mode:"cors",method:"GET",credentials:"include"}));case 3:if(200!==(a=c.sent).status){c.next=12;break}return c.next=7,g.a.awrap(a.json());case 7:n=c.sent,s=JSON.parse(n),t(s),c.next=13;break;case 12:console.log("not a 200");case 13:c.next=18;break;case 15:c.prev=15,c.t0=c.catch(0),console.log(c.t0);case 18:return c.prev=18,setTimeout((function(){e(t)}),5e3),c.finish(18);case 21:case"end":return c.stop()}}),null,null,[[0,15,18,21]])};var A=function(e,t,a){var n=Object(m.f)();return e.map((function(e,c){return s.a.createElement("div",{className:E.a.chatwrap,key:c.toString()},s.a.createElement("div",{onClick:function(s){n.push("".concat(window.publicUrl,"/chat")),a(Object(i.a)({},t,{openedChat:Object(i.a)({},t.openedChat,{chatId:e.chat_id})})),function(e,t){!function(e,t){var a,n,s;g.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,g.a.awrap(fetch(D+"chats/get_chat/"+e,{crossDomain:!0,mode:"cors",method:"GET",credentials:"include"}));case 3:if(200!==(a=c.sent).status){c.next=12;break}return c.next=7,g.a.awrap(a.json());case 7:n=c.sent,s=JSON.parse(n),t({appPage:"Chat",openedChat:{chatId:s.chat_id,topic:s.topic,messages:s.messages.reverse()},prevAppPage:"ChatList"}),c.next=13;break;case 12:console.log("not a 200");case 13:c.next=18;break;case 15:c.prev=15,c.t0=c.catch(0),console.log(c.t0);case 18:case"end":return c.stop()}}),null,null,[[0,15]])}(e,t)}(e.chat_id,a)},role:"button",tabIndex:0,className:E.a.wrap,id:e.chat_id},s.a.createElement("img",{className:E.a.chatImg,src:"http://emilcarlsson.se/assets/rachelzane.png",alt:""}),s.a.createElement("div",{className:E.a.meta},s.a.createElement("div",{className:E.a.topic},"".concat(e.chat__topic)," "),s.a.createElement("div",{className:E.a.preview},e.chat__last_message," ")),s.a.createElement("div",{className:E.a.addinfo},s.a.createElement("span",{className:E.a.dot}),s.a.createElement("p",null,"21:23"))))}))};function P(e){var t=e.chats,a=e.appState,n=e.setAppState;return s.a.createElement("div",{className:E.a.dialogsListContainer},null!==t&&A(t,a,n))}var M=function(e){var t=e.appState,a=e.setAppState,c=Object(n.useState)([]),r=Object(p.a)(c,2),o=r[0],l=r[1];return Object(n.useEffect)((function(){I(l)}),[]),s.a.createElement("div",{className:E.a.dialog_list_wrap},s.a.createElement(_,null),s.a.createElement(P,{chats:o,setChats:l,appState:t,setAppState:a}),s.a.createElement(T,{setChats:l,chats:o}))},H=a(45),z=a.n(H),U=a(46),F=a(22),R=a.n(F),B=a(25),G=a.n(B),V=a(16),J=a.n(V),K=a(26),X=a.n(K);var W=function(){return s.a.createElement("div",{className:X.a.arrow,style:{transform:"scale(-1, 1) scale(0.3)"}},s.a.createElement("div",{className:X.a.arrowTop}),s.a.createElement("div",{className:X.a.arrowBottom}))},Y='\n<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 512 512" style="max-height: 100%;" style="enable-background:new 0 0 512 512;" xml:space="preserve" fill="blue">\n<g>\n\t<g>\n\t\t<path d="M506.955,1.314c-3.119-1.78-6.955-1.75-10.045,0.078L313.656,109.756c-4.754,2.811-6.329,8.943-3.518,13.697\n\t\t\tc2.81,4.753,8.942,6.328,13.697,3.518l131.482-77.749L210.411,303.335L88.603,266.069l158.965-94\n\t\t\tc4.754-2.812,6.329-8.944,3.518-13.698c-2.81-4.753-8.943-6.33-13.697-3.518L58.91,260.392c-3.41,2.017-5.309,5.856-4.84,9.791\n\t\t\ts3.216,7.221,7.004,8.38l145.469,44.504L270.72,439.88c0.067,0.121,0.136,0.223,0.207,0.314c1.071,1.786,2.676,3.245,4.678,4.087\n\t\t\tc1.253,0.527,2.57,0.784,3.878,0.784c2.563,0,5.086-0.986,6.991-2.849l73.794-72.12l138.806,42.466\n\t\t\tc0.96,0.293,1.945,0.438,2.925,0.438c2.116,0,4.206-0.672,5.948-1.961C510.496,409.153,512,406.17,512,403V10\n\t\t\tC512,6.409,510.074,3.093,506.955,1.314z M271.265,329.23c-1.158,1.673-1.779,3.659-1.779,5.694v61.171l-43.823-79.765\n\t\t\tl193.921-201.21L271.265,329.23z M289.486,411.309v-62.867l48.99,14.988L289.486,411.309z M492,389.483l-196.499-60.116\n\t\t\tL492,45.704V389.483z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M164.423,347.577c-3.906-3.905-10.236-3.905-14.143,0l-93.352,93.352c-3.905,3.905-3.905,10.237,0,14.143\n\t\t\tC58.882,457.024,61.441,458,64,458s5.118-0.976,7.071-2.929l93.352-93.352C168.328,357.815,168.328,351.483,164.423,347.577z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M40.071,471.928c-3.906-3.903-10.236-3.903-14.142,0.001l-23,23c-3.905,3.905-3.905,10.237,0,14.143\n\t\t\tC4.882,511.024,7.441,512,10,512s5.118-0.977,7.071-2.929l23-23C43.976,482.166,43.976,475.834,40.071,471.928z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M142.649,494.34c-1.859-1.86-4.439-2.93-7.069-2.93c-2.641,0-5.21,1.07-7.07,2.93c-1.86,1.86-2.93,4.43-2.93,7.07\n\t\t\tc0,2.63,1.069,5.21,2.93,7.07c1.86,1.86,4.44,2.93,7.07,2.93s5.21-1.07,7.069-2.93c1.86-1.86,2.931-4.44,2.931-7.07\n\t\t\tC145.58,498.77,144.51,496.2,142.649,494.34z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M217.051,419.935c-3.903-3.905-10.233-3.905-14.142,0l-49.446,49.445c-3.905,3.905-3.905,10.237,0,14.142\n\t\t\tc1.953,1.953,4.512,2.929,7.071,2.929s5.118-0.977,7.071-2.929l49.446-49.445C220.956,430.172,220.956,423.84,217.051,419.935z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M387.704,416.139c-3.906-3.904-10.236-3.904-14.142,0l-49.58,49.58c-3.905,3.905-3.905,10.237,0,14.143\n\t\t\tc1.953,1.952,4.512,2.929,7.071,2.929s5.118-0.977,7.071-2.929l49.58-49.58C391.609,426.377,391.609,420.045,387.704,416.139z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M283.5,136.31c-1.86-1.86-4.44-2.93-7.07-2.93s-5.21,1.07-7.07,2.93c-1.859,1.86-2.93,4.44-2.93,7.08\n\t\t\tc0,2.63,1.07,5.2,2.93,7.06c1.86,1.87,4.44,2.93,7.07,2.93s5.21-1.06,7.07-2.93c1.859-1.86,2.93-4.43,2.93-7.06\n\t\t\tC286.43,140.75,285.36,138.17,283.5,136.31z"/>\n\t</g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n</svg>\n',q='\n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\tposition="relative" style="max-height: 100%;" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve" fill="blue">\n<g>\n\t<path d="M97.344,482.17c-23.311,0-45.215-9.084-61.689-25.555c-34.01-34.014-34.01-89.361,0-123.371L305.343,63.543\n\t\tc21.727-21.75,50.645-33.713,81.39-33.713c30.75,0,59.667,11.963,81.395,33.713c21.748,21.744,33.726,50.645,33.726,81.389\n\t\tc0,30.75-11.964,59.65-33.708,81.381L255.843,438.596c-6.374,6.371-16.696,6.371-23.067,0c-6.374-6.373-6.374-16.695,0-23.07\n\t\tl212.298-212.283c15.583-15.58,24.153-36.291,24.153-58.311c0-22.016-8.588-42.74-24.167-58.322\n\t\tc-15.583-15.58-36.294-24.154-58.327-24.154c-22.029,0-42.74,8.574-58.323,24.154L58.725,356.311\n\t\tc-21.283,21.301-21.283,55.938,0,77.234c20.645,20.617,56.589,20.617,77.233,0l181.091-181.105\n\t\tc4.924-4.924,7.745-11.74,7.745-18.688c0-7.045-2.755-13.686-7.759-18.689c-10.291-10.291-27.067-10.322-37.358,0L156,338.754\n\t\tc-6.37,6.375-16.697,6.375-23.067,0c-6.374-6.371-6.374-16.697,0-23.066l123.673-123.691c23.005-23.004,60.461-23.004,83.497,0\n\t\tc11.169,11.166,17.317,26,17.317,41.756c0,15.547-6.308,30.762-17.3,41.754L159.029,456.615\n\t\tC142.555,473.086,120.65,482.17,97.344,482.17z"/>\n</g>\n</svg>\n',Q='\n<?xml version="1.0" encoding="iso-8859-1"?>\n\x3c!-- Generator: Adobe Illustrator 18.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 317.001 317.001" style="enable-background:new 0 0 317.001 317.001;" xml:space="preserve">\n<path d="M270.825,70.55L212.17,3.66C210.13,1.334,207.187,0,204.093,0H55.941C49.076,0,43.51,5.566,43.51,12.431V304.57\n\tc0,6.866,5.566,12.431,12.431,12.431h205.118c6.866,0,12.432-5.566,12.432-12.432V77.633\n\tC273.491,75.027,272.544,72.51,270.825,70.55z M55.941,305.073V12.432H199.94v63.601c0,3.431,2.78,6.216,6.216,6.216h54.903\n\tl0.006,222.824H55.941z"/>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n</svg>',Z=function(){return{type:"HIDE_OR_DRAW_RECORDER_PAGE"}},$=a(35),ee=a(47),te=a(50),ae=a(36);function ne(){var e=Object($.a)(["\n  position: relative;\n  flex: 1;\n  height: 100%;\n  opacity: 0.3;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-color: #333;\n  font-size: 7vh;\n\n  &:hover {\n    opacity: 1;\n  }\n"]);return ne=function(){return e},e}function se(){var e=Object($.a)(["\n  position: relative;\n  flex: 1;\n  height: 100%;\n  opacity: 0.3;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    opacity: 1;\n  }\n  &:before,\n  &:after {\n    position: absolute;\n    content: ' ';\n    height: 30%;\n    width: 3px;\n    background-color: #333;\n  }\n  &:before {\n    transform: rotate(45deg);\n  }\n  &:after {\n    transform: rotate(-45deg);\n  }\n"]);return se=function(){return e},e}var ce=function e(t,a,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";Object(ee.a)(this,e),this.messageText=n,this.userId=a,this.time=re(),this.chatId=t,this.contentType=s,this.link=c,this.fileName=r};function re(){var e=new Date,t="".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()),a="".concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds());return"".concat(t," ").concat(a)}function oe(e,t,a){var n;return g.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return le(t,a,e),(n=new FormData).append("image",e),s.prev=3,s.next=6,g.a.awrap(fetch("https://tt-front.now.sh/upload",{method:"POST",body:n}));case 6:s.next=11;break;case 8:s.prev=8,s.t0=s.catch(3),console.error("\u041e\u0448\u0438\u0431\u043a\u0430:",s.t0);case 11:case"end":return s.stop()}}),null,null,[[3,8]])}function le(e,t,a){var n;n=void 0!==a.type&&a.type.includes("image")?"image":"file";var s=URL.createObjectURL(a),c=new ce(e.openedChat.chatId,O.userId,"",n,s,a.name);t(Object(i.a)({},e,{},Object.assign(e.openedChat,{messages:[].concat(Object(w.a)(e.openedChat.messages),[c])})))}var ie=ae.a.div(se()),pe=ae.a.div(ne());function ue(e){var t=e.appState,a=e.setAppState,c=Object(n.useState)({record:!1}),r=Object(p.a)(c,2),o=r[0],u=r[1],d=Object(l.c)((function(e){return e.isMessagePageOpen})),m=Object(l.b)(),h=function(){u({record:!1})};return s.a.createElement("div",{style:{width:"100%",height:"100%",position:"absolute",left:"0px",top:"0px",display:d?"flex":"none",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.4)"}},s.a.createElement("div",{style:{width:"80%",height:"60%",backgroundColor:"#fefefe",borderRadius:"25px",overflow:"hidden",display:"flex",flexDirection:"column"}},s.a.createElement("div",{style:{flex:"1"}},s.a.createElement(te.a,{record:o.record,className:"frequencyBars",onStop:function(e){console.log("recordedBlob is: ",e);var n=new ce(t.openedChat.chatId,O.userId,"","audioMessage",e.blobURL);m(Z()),a(Object(i.a)({},t,{},Object.assign(t.openedChat,{messages:[].concat(Object(w.a)(t.openedChat.messages),[n])}))),function(e){var t;g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return(t=new FormData).append("audio",e),a.prev=2,a.next=5,g.a.awrap(fetch("https://tt-front.now.sh/upload",{method:"POST",body:t}));case 5:a.next=10;break;case 7:a.prev=7,a.t0=a.catch(2),console.error("\u041e\u0448\u0438\u0431\u043a\u0430:",a.t0);case 10:case"end":return a.stop()}}),null,null,[[2,7]])}(e)},strokeColor:"blue",width:.8*window.screen.width,height:.3*window.screen.height})),s.a.createElement("div",{style:{flex:"1",justifyContent:"center",alignItems:"center",display:"flex"}},s.a.createElement(ie,{onClick:function(){h(),m(Z())}}),s.a.createElement(pe,{onClick:function(e){e.preventDefault(),o.record?h():u({record:!0})}},o.record?"Send":"Start"," "))))}function ge(e){var t;return g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return(t=new FormData).append("user_id",e.users_id),t.append("chat_id",e.chat_id),t.append("content",e.content),a.next=6,g.a.awrap(fetch(D+"chats/send_message",{method:"POST",body:t}));case 6:a.sent;case 7:case"end":return a.stop()}}))}function de(e){var t=e.topic,a=e.appState,n=e.setAppState,c=Object(m.f)();return s.a.createElement("div",{id:"chatTopLine",className:G.a.container},s.a.createElement("div",{id:"chatBack",onClick:function(e){clearTimeout(window.timerGettingMess),n(Object(i.a)({},a,{appPage:"ChatList",prevAppPage:c.location})),c.push("".concat(window.publicUrl,"/"))},onKeyDown:function(e){},style:{flex:"0.2"},role:"button",tabIndex:0},s.a.createElement(W,null)),s.a.createElement("div",{className:G.a.topic}," ",t," "))}function me(e){var t=e.messages,a=e.appState,c=e.setAppState,r=Object(n.useState)(!1),o=Object(p.a)(r,2),l=o[0],i=o[1],u=s.a.createRef(),g=Object(m.f)();Object(n.useEffect)((function(){u.current.scrollTop=u.current.scrollHeight}),[t]);return s.a.createElement("div",{className:J.a.result,style:{scrollTop:"scrollHeight"},ref:u,onDragEnter:function(e){e.preventDefault(),e.stopPropagation(),i(!0)}},s.a.createElement(fe,{dragging:l,handleDragOut:function(e){e.persist(),e.preventDefault(),e.stopPropagation(),i(!1)},handleDrop:function(e){(i(!1),e.preventDefault(),e.stopPropagation(),"file"===e.dataTransfer.items[0].kind)&&oe(e.dataTransfer.items[0].getAsFile(),a,c)}}),s.a.createElement(ue,{appState:a,setAppState:c}),t.map((function(e,t){return s.a.createElement("div",{key:t.toString(),className:R.a.singleMessContainer,onDrop:function(e){e.preventDefault()}},s.a.createElement("input",{type:"image",onClick:function(e){g.push("".concat(window.publicUrl,"/profile"),a)},className:G.a.chatImg,src:"http://emilcarlsson.se/assets/rachelzane.png",alt:"Avatar"}),s.a.createElement("div",{className:R.a.singleMess,sender:e.users_id===O.userId?"me":"him"},s.a.createElement("div",{className:R.a.singleMessText},function(){switch(e.contentType){case"link":return s.a.createElement("a",{href:e.messageText}," ",e.messageText," ");case"image":return s.a.createElement("img",{alt:"",src:e.link,style:{maxWidth:"100%"}});case"file":return s.a.createElement("div",{style:{display:"inline"}},s.a.createElement("a",{"aria-label":"location",dangerouslySetInnerHTML:{__html:Q},href:e.link,style:{height:"50%"}}),s.a.createElement("p",null,e.fileName));case"audioMessage":return s.a.createElement("div",null,s.a.createElement(z.a,{src:e.link,autoPlay:!0,controls:!0}));default:return s.a.createElement("div",null," ",e.messageText," ")}return"link"===e.contentType?s.a.createElement("a",{href:e.messageText}," ",e.content," "):s.a.createElement("div",null," ",e.content," ")}()),s.a.createElement("p",{className:R.a.dateTime}," ",e.added_at," ")))})))}function he(e){var t=e.appState,a=e.setAppState,n=Object(l.b)(),c=s.a.createRef(),r=s.a.createRef(),o=Object(U.usePosition)(),p=o.latitude,u=o.longitude;return s.a.createElement("div",{className:J.a.input_panel},s.a.createElement("form",{className:J.a.sendMessForm,onSubmit:function(e){e.preventDefault();var n=e.target[0].value;if(""!==n.replace(/\s/gi,"")){var s=new ce(t.openedChat.chatId,O.userId,n,"text");a(Object(i.a)({},t,{},Object.assign(t.openedChat,{messages:[].concat(Object(w.a)(t.openedChat.messages),[s])}))),ge(s),e.target[0].value=""}}},s.a.createElement("input",{ref:c,type:"text",className:J.a.messageText,maxLength:"512",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u0438\u043d\u0435"}),s.a.createElement("div",{style:{margin:"5px",flex:"0.3",maxHeight:"100%"}},s.a.createElement("div",{ref:r,className:J.a.attachmentType},s.a.createElement("label",{id:"input"},s.a.createElement("input",{type:"file",name:"file",onChange:function(e){r.current.style.transform="scale(0)",oe(e.target.files[0],t,a)},onKeyDown:function(e){},style:{display:"none"}}),s.a.createElement("div",null,"\u0424\u0430\u0439\u043b")),s.a.createElement("div",{role:"button",onClick:function(e){e.preventDefault();var n=new ce(t.openedChat.chatId,O.userId,"https://www.openstreetmap.org/#map=18/".concat(p,"/").concat(u),"link");ge(n),a(Object(i.a)({},t,{},Object.assign(t.openedChat,{messages:[].concat(Object(w.a)(t.openedChat.messages),[n])}))),r.current.style.transform="scale(0)"},onKeyDown:function(e){}},"\u041c\u043e\u044f \u0433\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u0438"),s.a.createElement("div",{onClick:function(e){n(Z()),r.current.style.transform="scale(0)"}}," ","\u0410\u0443\u0434\u0438\u043e\u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"," ")),s.a.createElement("div",{"aria-label":"send message",dangerouslySetInnerHTML:{__html:q},style:{height:"100%"},role:"button",tabIndex:-1,onKeyDown:function(){},onClick:function(e){r.current.style.transform="scale(1)"!==r.current.style.transform?"scale(1)":"scale(0)"}})),s.a.createElement("label",{style:{flex:"0.3",display:"flex",maxHeight:"100%"}},s.a.createElement("input",{style:{display:"none"},type:"submit",value:""}),s.a.createElement("div",{dangerouslySetInnerHTML:{__html:Y},style:{flex:"1",margin:"5px"}}))))}function fe(e){var t=e.dragging,a=e.handleDragOut,n=e.handleDrop;return t&&s.a.createElement("div",{onDragLeave:a,onDrop:n,onDragOver:function(e){e.preventDefault(),e.stopPropagation()},onDragEnter:function(e){e.preventDefault(),e.stopPropagation()},style:{border:"dashed grey 4px",backgroundColor:"rgba(255,255,255,.8)",position:"absolute",top:"10vh",bottom:"10vh",left:0,right:0,zIndex:9999}},s.a.createElement("div",{style:{position:"absolute",top:"50%",right:0,left:0,textAlign:"center",color:"grey",fontSize:36}},s.a.createElement("div",null,"drop here :)")))}var ve=function(e){var t=e.appState,a=e.setAppState;return Object(n.useEffect)((function(){console.log(t.openedChat),function e(t,a){var n,s,c;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,g.a.awrap(fetch(D+"chats/get_chat/"+t,{crossDomain:!0,mode:"cors",method:"GET",credentials:"include"}));case 3:if(200!==(n=r.sent).status){r.next=13;break}return r.next=7,g.a.awrap(n.json());case 7:s=r.sent,c=JSON.parse(s),a({appPage:"Chat",openedChat:{chatId:c.chat_id,topic:c.topic,messages:c.messages.reverse()},prevAppPage:"ChatList"}),console.log(c.messages),r.next=14;break;case 13:console.log("not a 200");case 14:r.next=19;break;case 16:r.prev=16,r.t0=r.catch(0),console.log(r.t0);case 19:return r.prev=19,window.timerGettingMess=setTimeout((function(){e(t,a)}),5e3),r.finish(19);case 22:case"end":return r.stop()}}),null,null,[[0,16,19,22]])}(t.openedChat.chatId,a)}),[]),s.a.createElement("div",{className:J.a.message_form},s.a.createElement(de,{topic:t.openedChat.topic,appState:t,setAppState:a}),s.a.createElement(me,{messages:t.openedChat.messages,appState:t,setAppState:a}),s.a.createElement(he,{appState:t,setAppState:a}))},_e=a(17),be=a.n(_e);function Ee(e){var t=e.appState,a=(e.setAppState,Object(m.f)());return s.a.createElement("div",{id:"profileTopLine",className:be.a.topLineContainer},s.a.createElement("div",{id:"profileBack",onClick:function(e){a.push("".concat(window.publicUrl,"/").concat(t.prevAppPage))},style:{flex:"0.2"},role:"button",tabIndex:0},s.a.createElement(W,null)),s.a.createElement("div",{className:be.a.profileTopic}," Profile Page "))}var we=function(e){var t=e.appState,a=e.setAppState;return s.a.createElement("div",{className:be.a.profile_form},s.a.createElement(Ee,{appState:t,setAppState:a}),s.a.createElement("img",{className:be.a.profileImg,src:"http://emilcarlsson.se/assets/rachelzane.png",alt:"Avatar"}),s.a.createElement("div",{className:be.a.name},"\u041a\u0438\u0440\u0438\u043b\u043b \u0427\u0435\u043a\u0430\u043d\u043e\u0432"),s.a.createElement("div",{className:be.a.status},"Status: no pain no gain"))};a(88);var xe=function(e){var t=Object(n.useState)({appPage:"",prevAppPage:"ChatList",openedChat:{chatId:-1,topic:"",messages:[]}}),a=Object(p.a)(t,2),c=a[0],r=a[1];return Object(n.useEffect)((function(){Array.isArray(JSON.parse(localStorage.getItem("DialogList")))||localStorage.clear(),function(){var e,t,a;g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,g.a.awrap(fetch(D+"users/whoami",{crossDomain:!0,mode:"cors",method:"GET",credentials:"include"}));case 3:if(200!==(e=n.sent).status){n.next=12;break}return n.next=7,g.a.awrap(e.json());case 7:t=n.sent,a=JSON.parse(t),O.userId=a.user_id,n.next=13;break;case 12:console.log("not a 200");case 13:n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),console.log(n.t0);case 18:case"end":return n.stop()}}),null,null,[[0,15]])}()}),[]),window.publicUrl="/static","/static"===window.publicUrl&&(window.publicUrl=""),s.a.createElement(d.a,null,s.a.createElement(h.a,{atEnter:{opacity:0},atLeave:{opacity:0},atActive:{opacity:1},className:"switch-wrapper"},s.a.createElement(m.a,{path:"".concat(window.publicUrl,"/chat/")},(function(e){return"Chat"!==c.appPage&&r(Object(i.a)({},c,{appPage:"Chat"})),s.a.createElement(ve,{appState:c,setAppState:r})})),s.a.createElement(m.a,{path:"".concat(window.publicUrl,"/")},(function(e){return"ChatList"!==c.appPage&&r(Object(i.a)({},c,{appPage:"ChatList",prevAppPage:c.appPage})),s.a.createElement(M,{appState:c,setAppState:r})})),s.a.createElement(m.a,{path:"".concat(window.publicUrl,"/profile/")},(function(e){return"ProfilePage"!==c.appPage&&r(Object(i.a)({},c,{appPage:"ProfilePage",prevAppPage:c.appPage})),s.a.createElement(we,{appState:c,setAppState:r})}))))},ye=Object(o.b)({isMessagePageOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HIDE_OR_DRAW_RECORDER_PAGE":return!e;default:return e}}}),Se=Object(o.c)(ye,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());r.a.render(s.a.createElement(l.a,{store:Se},s.a.createElement(xe,null)),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.a75b8d17.chunk.js.map